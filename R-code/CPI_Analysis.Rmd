---
title: "CPI_Analysis"
author: "Anju John"
date: "9 December 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```
-----Data Preparation-------

data = read.xlsx("CPM15_ma.xlsx",1)
head(data)

df <- rename(data,c('Harmonised.Consumer.Price.Index.by.Month..Statistic.and.Commodity.Group'='Year','NA.'='Food & Beverages', 'NA..1'='Recreation & Culture' , 'NA..2'='Newspaper & Publications', 'NA..3'='Restaurants & Accomodation','NA..4'='Goods & Services'))
df <- df[c(-1,-2),]
df <- df[(-190:-210),]
head(df)

df$Year=lubridate::ymd(df$Year,truncated=2L)

df$`Food & Beverages` <- as.numeric(as.character(df$`Food & Beverages`))
df$`Recreation & Culture` <- as.numeric(as.character(df$`Recreation & Culture`))
df$`Newspaper & Publications` <- as.numeric(as.character(df$`Newspaper & Publications`))
df$`Restaurants & Accomodation` <- as.numeric(as.character(df$`Restaurants & Accomodation`))
df$`Goods & Services` <- as.numeric(as.character(df$`Goods & Services`))

tsData = data.matrix(df)
tsData = ts(tsData ,start = c(2003,1),end = c(2018,9),frequency = 12)
tsData = tsData[,c(-1)]


#splitting the data
tsData.end <- floor(0.8*length())
str(tsData)
components.tsData = decompose(tsData)
plot(components.tsData)

autoplot(tsData) +
  ggtitle("Tourism and Hospitality Sector- Harmonised Consumer Price Index") +
  ylab("Moving 12 months average index in HICP (Base 2015=100)") +
  xlab("Year")

#Before and after data for food and beverage
f_1 <- window(tsData[,1], end = c(2011,6))
f_2 <- window(tsData[,1], start = c(2011,7))
t.test(f_1, f_2)
#reject null hypothesis. 


#-------T&H before 2011/07-----------------------
tsBefore2011 = window(tsData,start=c(2003,1),end=c(2011,6))
autoplot(tsBefore2011) +
  ggtitle("Tourism and Hospitality Sector- Harmonised Consumer Price Index , Before the 9% VAT implementation") +
  ylab("Moving 12 months average index in HICP (Base 2015=100)") +
  xlab("Year")

food1= window(tsBefore2011[,1],start=c(2003,1),end=c(2011,6))
recreation1= window(tsBefore2011[,2],start=c(2003,1),end=c(2011,6))
newspaper1= window(tsBefore2011[,3],start=c(2003,1),end=c(2011,6))
restaurants1= window(tsBefore2011[,4],start=c(2003,1),end=c(2011,6))
goods1= window(tsBefore2011[,5],start=c(2003,1),end=c(2011,6))

#-------T&H after 2011/07-------------------------

tsAfter2011=window(tsData,start=c(2011,7),end=c(2018,9))
autoplot(tsAfter2011) +
  ggtitle("Tourism and Hospitality Sector- Harmonised Consumer Price Index , After the 9% VAT implementation") +
  ylab("Moving 12 months average index in HICP (Base 2015=100)") +
  xlab("Year")

food2= window(tsAfter2011[,1],start=c(2011,7),end=c(2018,9))
recreation2= window(tsAfter2011[,2],start=c(2011,7),end=c(2018,9))
newspaper2= window(tsAfter2011[,3],start=c(2011,7),end=c(2018,9))
restaurants2= window(tsAfter2011[,4],start=c(2011,7),end=c(2018,9))
goods2= window(tsAfter2011[,5],start=c(2011,7),end=c(2018,9))

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
